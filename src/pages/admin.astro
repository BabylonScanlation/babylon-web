---
// src/pages/admin.astro
import Layout from '../layouts/Layout.astro';

const sessionCookie = Astro.cookies.get('session');
const isAdmin = sessionCookie?.value === 'admin-logged-in';

if (!isAdmin) {
  return Astro.redirect('/admin-login');
}

const success = Astro.url.searchParams.get('success');
const error = Astro.url.searchParams.get('error');
---

<Layout title="Panel de Administración">
  <main class="admin-container">
    <h1>Panel de Administración</h1>

    {success && <p class="success-message">{success}</p>}
    {error && <p class="error-message">{error}</p>}

    <div class="admin-actions">
      <form action="/api/admin-logout" method="post">
        <button type="submit" class="logout-btn">Cerrar Sesión</button>
      </form>
    </div>

    <div class="admin-dashboard">
      <a href="/admin/series" class="dashboard-card">
        <h2>Gestionar Series</h2>
        <p>
          Edita los detalles de las series y elimina capítulos o series
          completas.
        </p>
      </a>

      <a href="/admin/comments" class="dashboard-card">
        <h2>Gestionar Comentarios</h2>
        <p>Modera y elimina los comentarios de las series y capítulos.</p>
      </a>

      <a href="/admin/upload" class="dashboard-card">
        <h2>Subir Capítulos</h2>
        <p>Sube nuevos capítulos para las series existentes vía Telegram.</p>
      </a>
    </div>
  </main>
</Layout>

<style>
  .admin-container {
    /* --- CORRECCIÓN AQUÍ --- */
    padding: 2rem;
    max-width: 1200px;
    margin: 0 auto;
    color: #fff;
  }
  h1 {
    font-size: 2.5rem;
    margin-bottom: 1.5rem;
    border-bottom: 1px solid #444;
    padding-bottom: 1rem;
  }
  .admin-actions {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 2rem;
  }
  .logout-btn {
    padding: 0.75rem 1.5rem;
    background-color: #c0392b;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
  }
  .admin-dashboard {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
  }
  .dashboard-card {
    background-color: var(--card-background);
    padding: 1.5rem;
    border-radius: 8px;
    transition:
      transform 0.2s ease-in-out,
      box-shadow 0.2s ease-in-out;
    border: 1px solid transparent;
  }
  .dashboard-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    border-color: var(--accent-color);
  }
  .success-message,
  .error-message {
    padding: 1rem;
    margin-bottom: 1rem;
    border-radius: 4px;
    text-align: center;
  }
  .success-message {
    background-color: rgba(46, 204, 113, 0.2);
    color: #2ecc71;
  }
  .error-message {
    background-color: rgba(231, 76, 60, 0.2);
    color: #e74c3c;
  }
</style>
